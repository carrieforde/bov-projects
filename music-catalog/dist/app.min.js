"use strict";!function(){var t,e=[{artist:"BadBadNotGood",album:"IV"},{artist:"STS9",album:"Artifact"},{artist:"Disclosure",album:"Settle"},{artist:"Caribou",album:"Our Love"},{artist:"Kellis",album:"Food"},{artist:"Quantic",album:"An Announcement to Answer"},{artist:"Prefuse 73",album:"One Word Extinguisher"},{artist:"Cinematic Orchestra",album:"Man with a Movie Camera"},{artist:"Beastie Boys",album:"Check Your Head"},{artist:"Gramatik",album:"Beatz & Pieces Vol. 1"},{artist:"Bonobo",album:"Migration"},{artist:"Flying Lotus",album:"Cosmogramma"}];if("indexedDB"in window){var a=window.indexedDB.open("albumsDB",1);a.onsuccess=function(){t=a.result,o()},a.onerror=function(t){console.log(t.target.errorCode)},a.onupgradeneeded=function(){event.target.result.createObjectStore("albums",{keyPath:"name"}).createIndex("artist","artist")}}function n(){var a="",n="";e.forEach(function(e){var r,s;a=e.artist,n=e.album,r=a,s=n,new Promise(function(t,e){var a=new XMLHttpRequest;a.onload=function(){var e=void 0,n=void 0,o="";if(200===a.status)return!(n=JSON.parse(a.response)).error&&(n.album.wiki&&(o=n.album.wiki.content),e={name:n.album.name,artist:n.album.artist,tracklist:n.album.tracks,image:n.album.image[4]["#text"],notes:o},t(e),!0)},a.onerror=function(){e("Sorry, we were unable to complete the reqeust.")},a.open("GET","https://ws.audioscrobbler.com/2.0/?method=album.getinfo&api_key=872e3d8c471503897c1a95005ef390b9&artist="+r+"&album="+s+"&format=json"),a.send()}).then(function(e){var a,n,r;a=e,n=t.transaction("albums","readwrite"),r=n.objectStore("albums"),n.oncomplete=function(){o()},n.onerror=function(){var t=document.getElementById("albums");t.innerHTML="<p>Whoa! We've experienced a problem.</p>"},r.add(a)},function(t){console.log(t)})})}function o(){var e=document.getElementById("albums"),a="",o="",r=void 0;t.transaction("albums").objectStore("albums").getAll().onsuccess=function(t){0===(r=t.target.result).length&&n(),r.forEach(function(t){a='\n\t\t\t\t\t\t<article class="album" data-album="'+t.name+'">\n\t\t\t\t\t\t\t<img class="album__image" src="'+t.image+'" alt="'+t.name+'">\n\t\t\t\t\t\t\t<h2 class="album__name">'+t.name+'</h2>\n\t\t\t\t\t\t\t<p class="album__artist">'+t.artist+"</p>\n\t\t\t\t\t\t</article>\n\t\t\t\t\t",o+=a}),e.innerHTML=o}}document.addEventListener("click",function(e){var a,n,o,r,s,i,c=e.target;c.closest(".album")&&(a=c.closest(".album"),n=a.dataset.album,o=document.querySelector(".modal-content"),r=void 0,s="",i=void 0,t.transaction("albums").objectStore("albums").get(n).onsuccess=function(t){(r=t.target.result).tracklist.track.forEach(function(t){s+='<li class="tracklist__track"><a href="'+t.url+'">'+t.name+"</a></li>"}),0===s.length&&(s="Sorry, this tracklist is unavailable."),i='\n\t\t\t\t\t<header class="modal-content__header">\n\t\t\t\t\t\t<img src="'+r.image+'" alt="'+r.name+'">\n\t\t\t\t\t\t<h2 id="modal-label">'+r.name+"</h2>\n\t\t\t\t\t\t<p>"+r.artist+"</p>\n\t\t\t\t\t\t<div>"+r.notes+'</div>\n\t\t\t\t\t\t<button type="button" class="button button--close">\n\t\t\t\t\t\t\t<span class="screen-reader-text">Close</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</header>\n\t\t\t\t\t<div id="modal-content" class="modal-content__content">\n\t\t\t\t\t\t<h3>Tracklist</h3>\n\t\t\t\t\t\t<ul class="tracklist list-reset">'+s+"</ul>\n\t\t\t\t\t</div>\n\t\t\t\t",o.innerHTML=i})})}(),function(){function t(){var t=document.querySelector(".modal-container");document.querySelector("body").classList.remove("modal-open"),t.classList.add("modal-container--hidden")}document.addEventListener("click",function(e){var a,n,o=e.target;o.closest(".album")&&(a=document.querySelector(".modal-container"),n=document.querySelector("body"),a.classList.remove("modal-container--hidden"),n.classList.add("modal-open")),(o.classList.contains("button--close")||o.classList.contains("modal-container"))&&t()}),document.addEventListener("keyup",function(e){var a=e.keyCode,n=document.querySelector(".modal-container");27!==a||n.classList.contains("modal-container--hidden")||t()})}();